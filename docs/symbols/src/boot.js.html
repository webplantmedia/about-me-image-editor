<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <link rel=stylesheet href="../../css/code.css" type="text/css"></head><body><pre><span class='linenumber'>   1</span> <span class="COMM">/**
<span class='linenumber'>   2</span>  * @class Main ImageEditor class
<span class='linenumber'>   3</span>  * @returns {Object}
<span class='linenumber'>   4</span>  */</span><span class="WHIT">
<span class='linenumber'>   5</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ImageEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>   6</span> </span><span class="WHIT">    </span><span class="NAME">this.editor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>   7</span> </span><span class="WHIT">    </span><span class="NAME">this.panel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>   8</span> </span><span class="WHIT">    </span><span class="NAME">this.toolbar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>   9</span> </span><span class="WHIT">    </span><span class="NAME">this.window</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  10</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>  11</span>      * Constructor function for this class
<span class='linenumber'>  12</span>      * 
<span class='linenumber'>  13</span>      * @public
<span class='linenumber'>  14</span>      * @constructs
<span class='linenumber'>  15</span>      */</span><span class="WHIT">
<span class='linenumber'>  16</span> </span><span class="WHIT">    </span><span class="NAME">this.__constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  17</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">u</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">config.presets</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  18</span> </span><span class="WHIT">        </span><span class="NAME">this.editor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  19</span> </span><span class="WHIT">            </span><span class="NAME">container</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">config.container</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  20</span> </span><span class="WHIT">            </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">config.width</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  21</span> </span><span class="WHIT">            </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">config.height</span><span class="WHIT">
<span class='linenumber'>  22</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  23</span> </span><span class="WHIT">        </span><span class="NAME">this.window</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">imageEditor.uiWindowElement</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  24</span> </span><span class="WHIT">            </span><span class="NAME">shapes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">imageEditor.SHAPES</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  25</span> </span><span class="WHIT">            </span><span class="NAME">editor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.editor</span><span class="WHIT">
<span class='linenumber'>  26</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  27</span> </span><span class="WHIT">        </span><span class="NAME">this.panel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">imageEditor.uiPanelElement</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  28</span> </span><span class="WHIT">            </span><span class="NAME">settings</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">imageEditor.SETTINGS</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  29</span> </span><span class="WHIT">            </span><span class="NAME">editor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.editor</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  30</span> </span><span class="WHIT">            </span><span class="NAME">window</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.window</span><span class="WHIT">
<span class='linenumber'>  31</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  32</span> </span><span class="WHIT">        </span><span class="NAME">this.toolbar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">imageEditor.uiToolbarElement</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  33</span> </span><span class="WHIT">            </span><span class="NAME">panel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.panel</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  34</span> </span><span class="WHIT">            </span><span class="NAME">editor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.editor</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  35</span> </span><span class="WHIT">            </span><span class="NAME">window</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.window</span><span class="WHIT">
<span class='linenumber'>  36</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  37</span> </span><span class="WHIT">        </span><span class="NAME">this.editor.on</span><span class="PUNC">(</span><span class="STRN">"deselect-all"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  38</span> </span><span class="WHIT">            </span><span class="NAME">self.panel.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  39</span> </span><span class="WHIT">            </span><span class="NAME">self.toolbar.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  40</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  41</span> </span><span class="WHIT">        </span><span class="NAME">this.editor.on</span><span class="PUNC">(</span><span class="STRN">"item-selected"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  42</span> </span><span class="WHIT">            </span><span class="NAME">self.toolbar.update</span><span class="PUNC">(</span><span class="NAME">obj.type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  43</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  44</span> </span><span class="WHIT">        </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">localStorage.editor</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">localStorage.editor</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">r.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">u</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  45</span> </span><span class="WHIT">        </span><span class="NAME">this.editor.loadConfig</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  46</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  47</span> </span><span class="WHIT">    </span><span class="NAME">this.__constructor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  48</span> </span><span class="PUNC">}</span><span class="PUNC">;</span></pre></body></html>